;; -*- mode: emacs-lisp; coding: utf-8-unix -*-
;; Minibuffer history file, automatically generated by `savehist'.

(setq savehist-minibuffer-history-variables '(org-refile-history TeX-command-history TeX-macro-history LaTeX-environment-history ediff-filtering-regexp-history extended-command-history gud-gud-gdb-history buffer-name-history file-name-history gud-gdb-history ido-buffer-history org-read-date-history org-tags-history query-replace-history ido-file-history minibuffer-history))
(setq TeX-macro-history '("section"))
(setq LaTeX-environment-history '("bmatrix" "equation" "align" "table" "tabular" "figure" "eequa" "aligh" "euqtion" "gather" "section" "document" "option"))
(setq gud-gud-gdb-history '("gdb --fullname "))
(setq buffer-name-history '("*shell*" "*shell*<2>" "*shell*<6>" "*shell*<5>" "*shell*<4>" "*shell*<3>"))
(setq file-name-history '("~/org/knowledge/writing/report9/report9.org" "~/org/knowledge/writing/report11/report11.tex" "~/org/knowledge/writing/report11/report11.org" "/home/yu/org/knowlege.org" "~/org/knowledge/writing/report10/PRB.tex" "~/org/datetree.org" "~/org/knowledge/writing/report9/report9.org" "~/org/knowledge/writing/report11/report11.org" "~/org/datetree.org" "/home/yu/org/gtd.org" "/home/yu/org/knowledge/writing/report11/report11.org" "~/org/datetree.org" "/home/yu/org/knowledge/writing/report11/report.org" "~/org/knowledge/writing/report11/report11" "~/org/knowlege.org" "~/org/datetree.org" "~/org/gtd.org" "/home/yu/org/test.org" "/home/yu/.Xauthority" "~/org/datetree.org" "~/org/datetree.org" "~/FlurryPP/src/flux.cpp" "~/FR-LES/src/flux.cpp" "~/FlurryPP/src/face.cpp" "~/FR-LES/src/face.cpp" "~/FlurryPP/src/ele.cpp" "~/FR-LES/src/ele.cpp" "~/FlurryPP/src/boundFace.cpp" "~/FR-LES/src/boundFace.cpp" "~/FlurryPP/include/mpiFace.hpp" "~/FR-LES/include/mpiFace.hpp" "~/FlurryPP/include/mesh.hpp" "~/FR-LES/include/mesh.hpp" "~/FlurryPP/include/matrix.hpp" "~/FR-LES/include/matrix.hpp" "~/FlurryPP/include/intFace.hpp" "~/FR-LES/include/intFace.hpp" "~/FlurryPP/include/input.hpp" "~/FR-LES/include/input.hpp" "~/FlurryPP/include/global.hpp" "~/FR-LES/include/global.hpp" "~/FlurryPP/include/geo.hpp" "~/FR-LES/include/geo.hpp" "~/FlurryPP/include/funcs.hpp" "~/FR-LES/include/funcs.hpp" "~/FlurryPP/include/flux.hpp" "~/FR-LES/include/flux.hpp" "~/FlurryPP/include/face.hpp" "~/FR-LES/include/face.hpp" "~/FlurryPP/include/error.hpp" "~/FR-LES/include/error.hpp" "~/FlurryPP/include/ele.hpp" "~/FR-LES/include/ele.hpp" "~/FlurryPP/include/boundFace.hpp" "~/FR-LES/include/boundFace.hpp" "~/org/datetree.org" "~/org/datetree.org" "~/org/datetree.org" "~/FlurryPP/src/face.cpp" "~/FlurryPP/src/flux.cpp" "~/FlurryPP/src/intFace.cpp" "/home/yu/FlurryPP/src/boundFace.cpp" "~/org/datetree.org" "~/org/datetree.org" "~/org/datetree.org" "~/.emacs.d/init.el" "~/org/knowledge/writing/report10/PRB.bbl" "~/org/knowledge/writing/report10/PRB.log" "~/org/knowledge/writing/report9/report.tex" "~/org/knowledge/writing/report10/PRB.log" "/usr/share/texlive/texmf-dist/tex/xelatex/xecjk/xeCJK.sty" "~/org/knowledge/writing/report10/PRB.log" "/usr/share/texlive/texmf-dist/tex/xelatex/xecjk/xeCJK.sty" "~/org/knowledge/writing/report10/PRB.tex" "~/org/knowledge/writing/report10/_region_.tex" "~/org/knowledge/writing/report10/PRB.log" "/usr/share/texlive/texmf-dist/tex/xelatex/xecjk/xeCJK.sty" "~/diary" "~/org/datetree.org" "~/org/knowledge/writing/report10/PRB.tex" "~/org/datetree.org" "/home/yu/org/datetree.org" "~/test.log" "/usr/share/texlive/texmf-dist/tex/xelatex/xecjk/xeCJK.sty" "/home/yu/test.tex" "~/org/datetree.org" "~/org/knowledge/writing/report9/report.tex" "~/org/knowledge/writing/report10/PRB.log" "~/org/knowledge/writing/report10/PRB.tex" "/home/yu/test1.org" "~/FR-LES/include/input.hpp" "~/FR-LES/src/input.cpp" "~/FR-LES/src/frles.cpp" "/home/yu/FR-LES/include/boundFace.hpp" "~/FR-LES/include/superMesh.hpp" "~/Downloads/FR-LES/include/superMesh.hpp" "~/FR-LES/include/solver.hpp" "~/Downloads/FR-LES/include/solver.hpp" "~/FR-LES/include/polynomials.hpp" "~/Downloads/FR-LES/include/polynomials.hpp" "~/FR-LES/include/points.hpp" "~/Downloads/FR-LES/include/points.hpp" "~/FR-LES/include/overFace.hpp" "~/Downloads/FR-LES/include/overFace.hpp" "~/FR-LES/include/overComm.hpp" "~/Downloads/FR-LES/include/overComm.hpp" "~/FR-LES/include/output.hpp" "~/Downloads/FR-LES/include/output.hpp" "~/FR-LES/include/operators.hpp" "~/Downloads/FR-LES/include/operators.hpp" "~/FR-LES/include/multigrid.hpp" "~/Downloads/FR-LES/include/multigrid.hpp" "~/FR-LES/include/mpiFace.hpp" "~/Downloads/FR-LES/include/mpiFace.hpp" "~/FR-LES/include/matrix.hpp" "~/Downloads/FR-LES/include/matrix.hpp" "~/FR-LES/include/intFace.hpp" "~/Downloads/FR-LES/include/intFace.hpp" "~/FR-LES/include/input.hpp" "~/Downloads/FR-LES/include/input.hpp" "~/FR-LES/include/global.hpp" "~/Downloads/FR-LES/include/global.hpp" "~/FR-LES/include/geo.hpp" "~/Downloads/FR-LES/include/geo.hpp" "~/FR-LES/include/funcs.hpp" "~/Downloads/FR-LES/include/funcs.hpp" "~/FR-LES/include/frles.hpp" "~/Downloads/FR-LES/include/frles.hpp" "~/FR-LES/include/flux.hpp" "~/Downloads/FR-LES/include/flux.hpp" "~/FR-LES/include/face.hpp" "~/Downloads/FR-LES/include/face.hpp" "~/FR-LES/include/error.hpp" "~/Downloads/FR-LES/include/error.hpp" "~/FR-LES/include/ele.hpp" "~/Downloads/FR-LES/include/ele.hpp" "~/FR-LES/include/boundFace.hpp" "~/Downloads/FR-LES/include/boundFace.hpp" "~/FR-LES/src/superMesh.cpp" "~/Downloads/FR-LES/src/superMesh.cpp" "~/FR-LES/src/solver_overset.cpp" "~/Downloads/FR-LES/src/solver_overset.cpp" "~/FR-LES/src/solver.cpp" "~/Downloads/FR-LES/src/solver.cpp" "~/FR-LES/src/polynomials.cpp" "~/Downloads/FR-LES/src/polynomials.cpp" "~/FR-LES/src/points.cpp" "~/Downloads/FR-LES/src/points.cpp" "~/FR-LES/src/overFace.cpp" "~/Downloads/FR-LES/src/overFace.cpp" "~/FR-LES/src/overComm.cpp" "~/Downloads/FR-LES/src/overComm.cpp" "~/FR-LES/src/output.cpp" "~/Downloads/FR-LES/src/output.cpp" "~/FR-LES/src/operators.cpp" "~/Downloads/FR-LES/src/operators.cpp" "~/FR-LES/src/multigrid.cpp" "~/Downloads/FR-LES/src/multigrid.cpp" "~/FR-LES/src/mpiFace.cpp" "~/Downloads/FR-LES/src/mpiFace.cpp" "~/FR-LES/src/matrix.cpp" "~/Downloads/FR-LES/src/matrix.cpp" "~/FR-LES/src/intFace.cpp" "~/Downloads/FR-LES/src/intFace.cpp" "~/FR-LES/src/input.cpp" "~/Downloads/FR-LES/src/input.cpp" "~/FR-LES/src/global.cpp" "~/Downloads/FR-LES/src/global.cpp" "~/FR-LES/src/geo_overset.cpp" "~/Downloads/FR-LES/src/geo_overset.cpp" "~/FR-LES/src/geo.cpp" "~/Downloads/FR-LES/src/geo.cpp" "~/FR-LES/src/funcs.cpp" "~/Downloads/FR-LES/src/funcs.cpp" "~/Downloads/FR-LES/src/frles.cpp" "~/FR-LES/src/flux.cpp" "~/Downloads/FR-LES/src/flux.cpp" "~/FR-LES/src/face.cpp" "~/Downloads/FR-LES/src/face.cpp" "~/FR-LES/src/ele.cpp" "~/Downloads/FR-LES/src/ele.cpp" "~/FR-LES/src/boundFace.cpp" "~/Downloads/FR-LES/src/boundFace.cpp" "~/FR-LES/src/frles.cpp" "/usr/include/c++/4.9/bits/stl_vector.h" "~/FR-LES/src/matrix.cpp" "~/FR-LES/src/input.cpp" "~/FR-LES/src/frles.cpp" "/home/yu/working/LES&nature_convection/R-B/Ra10E6/vertical/A=1/input" "~/FR-LES/configfiles/default.config" "~/FR-LES/include/flux.hpp" "~/FR-LES/src/flux.cpp" "~/FR-LES/src/ele.cpp" "/home/yu/FR-LES/src/solver.cpp" "~/FlurryPP/src/solver.cpp" "~/FR-LES/src/solver.cpp" "~/FlurryPP/src/output.cpp" "~/FR-LES/src/output.cpp" "~/FlurryPP/src/input.cpp" "~/FR-LES/src/input.cpp" "~/FlurryPP/src/global.cpp" "~/FR-LES/src/global.cpp" "~/FlurryPP/src/flux.cpp" "~/FR-LES/src/flux.cpp" "~/FlurryPP/src/face.cpp" "~/FR-LES/src/face.cpp" "~/FlurryPP/src/ele.cpp" "~/FR-LES/src/ele.cpp" "~/FlurryPP/src/boundFace.cpp" "~/FR-LES/src/boundFace.cpp" "~/FR-LES/include/solver.hpp" "~/FlurryPP/include/solver.hpp" "~/FR-LES/include/input.hpp" "~/FlurryPP/include/input.hpp" "~/FR-LES/include/global.hpp" "~/FlurryPP/include/global.hpp" "~/FR-LES/include/flux.hpp" "~/FlurryPP/include/flux.hpp" "~/Documents/FR-LES/src/flux.cpp" "~/Documents/FR-LES/src/solver.cpp" "/home/yu/Documents/FR-LES/include/flux.hpp" "~/Documents/FR-LES/include/solver.hpp" "~/FlurryPP/include/solver.hpp" "~/FR-LES/src/face.cpp" "~/FR-LES/src/solver.cpp" "~/FR-LES/src/input.cpp" "~/FR-LES/src/frles.cpp" "~/working/Preconditioning/lid-driven/Flurry/Ma0.01/32/p2/pre/input" "~/org/knowledge/CS/EDB/editor-IDE.org/edit.org" "~/FlurryPP/src/face.cpp" "~/FlurryPP/src/flux.cpp" "~/FlurryPP/src/solver.cpp" "~/FlurryPP/src/flurry.cpp" "~/.emacs.d/init.el" "~/FlurryPP/src/funcs.cpp" "~/org/datetree.org" "~/FR-LES/include/superMesh.hpp" "~/FR-LES/include/solver.hpp" "~/FR-LES/include/polynomials.hpp" "~/FR-LES/include/points.hpp" "~/FR-LES/include/overFace.hpp" "~/FR-LES/include/overComm.hpp" "~/FR-LES/include/output.hpp" "~/FR-LES/include/operators.hpp" "~/FR-LES/include/multigrid.hpp" "~/FR-LES/include/mpiFace.hpp" "~/FR-LES/include/mesh.hpp" "~/FR-LES/include/matrix.hpp" "~/FR-LES/include/intFace.hpp" "~/FR-LES/include/input.hpp" "~/FR-LES/include/global.hpp" "~/FR-LES/include/geo.hpp" "~/FR-LES/include/funcs.hpp" "~/FR-LES/include/frles.hpp" "~/FR-LES/include/flux.hpp" "~/FR-LES/include/face.hpp" "~/FR-LES/include/error.hpp" "~/FR-LES/include/ele.hpp" "~/FR-LES/include/boundFace.hpp" "~/FR-LES/src/superMesh.cpp" "~/FR-LES/src/solver_overset.cpp" "~/FR-LES/src/solver.cpp" "~/FR-LES/src/polynomials.cpp" "~/FR-LES/src/points.cpp" "~/FR-LES/src/overFace.cpp" "~/FR-LES/src/overComm.cpp" "~/FR-LES/src/output.cpp" "~/FR-LES/src/operators.cpp" "~/FR-LES/src/multigrid.cpp" "~/FR-LES/src/mpiFace.cpp" "~/FR-LES/src/mesh.cpp" "~/FR-LES/src/matrix.cpp" "~/FR-LES/src/intFace.cpp" "~/FR-LES/src/input.cpp" "~/FR-LES/src/global.cpp" "~/FR-LES/src/geo_overset.cpp" "~/FR-LES/src/geo.cpp" "~/FR-LES/src/funcs.cpp" "~/FR-LES/src/flux.cpp" "~/FR-LES/src/face.cpp" "~/FR-LES/src/ele.cpp" "~/FR-LES/src/boundFace.cpp" "/home/yu/FR-LES/src/frles.cpp" "~/FR-LES/src/flurry.cpp" "~/FR-LES/obj/README" "~/FR-LES/makefile" "~/FR-LES/configfiles/default.config" "~/FR-LES/planning" "/home/yu/FR-LES/README.org" "/home/yu/FR-LES/README.md" "/usr/share/emacs/24.4/etc/COPYING" "~/.emacs.d/init.el" "~/org/datetree.org" "~/FlurryPP/src/mpiFace.cpp" "~/diary" "~/FlurryPP/src/boundFace.cpp" "~/working/Preconditioning/lid-driven/Flurry/Ma0.01/32/p2/Re400/input" "~/org/datetree.org" "~/FlurryPP/src/input.cpp" "~/.emacs.d/init.el" "~/working/Preconditioning/lid-driven/Flurry/Ma0.01/32/p2/pre/input" "~/FlurryPP/configfiles/default.config" "~/FlurryPP/src/face.cpp" "~/FlurryPP/src/flux.cpp" "~/FlurryPP/src/flurry.cpp" "~/FlurryPP/src/solver.cpp" #("/home/yu/FlurryPP/src/ele.cpp" 9 18 (face flx-highlight-face)) "~/org/gtd.org" "~/FlurryPP/src/ele.cpp" "~/FlurryPP/src/face.cpp" "~/FlurryPP/src/intFace.cpp" "~/FlurryPP/src/flux.cpp" "~/FlurryPP/src/solver.cpp" "/home/yu/FlurryPP/src/flurry.cpp" "~/FlurryPP/src/flurry.cpp" "~/CFD/FlurryPP/src/ele.cpp" "~/CFD/FlurryPP/src/flurry.cpp" "~/CFD/FlurryPP/src/geo.cpp" "~/CFD/FlurryPP/src/funcs.cpp" "~/CFD/FlurryPP/src/flux.cpp" "~/CFD/FlurryPP/src/face.cpp" "/home/yu/CFD/FlurryPP/src/boundFace.cpp" "~/org/datetree.org" "~/CFD/FlurryPP/src/solver.cpp" "/home/yu/CFD/FlurryPP/src/flurry.cpp" "~/CFD/FlurryPP-master/src/solver.cpp" "~/.emacs.d/init.el" "~/working/Preconditioning/lid-driven/Flurry/Ma0.05/Re100/p2/pre/input" "~/working/Preconditioning/lid-driven/Flurry/Ma0.05/Re100/p2/pre/cavity.msh" "~/working/Preconditioning/lid-driven/Flurry/Ma0.05/Re100/p2/pre/cavity.geo" "~/diary" "~/org/gtd.org_archive" "~/.emacs.d/ede-projects.el" "~/.emacs.d/lisp/init-fonts.el" "~/Downloads/ANSYS Products 16.1 Linux64/ANSYS_16.1_Linux64_crack_SSQ/Crack without License Server setup/readme.txt" "~/WorkbenchLogs/CoreEvents19836.log" "~/Downloads/ANSYS.14.5.0.LINUX64/INSTALL" "~/Downloads/ANSYS.14.5.0.LINUX64/licgen/install.txt" "~/working/LES&nature_convection/R-B/Ra10E6/vertical/A=1/input" "~/working/LES&nature_convection/R-B/R-B.geo" "/home/yu/working/LES&nature_convection/R-B/input" #("/home/yu/.emacs.d/lisp/init-fonts.el" 23 31 (face flx-highlight-face)) "~/.emacs_d_bak4/custom.el" "~/.emacs.d/company-statistics-cache.el" "~/.emacs.d/recentf"))
(setq gud-gdb-history '("gdb -i=mi "))
(setq org-read-date-history '("   " "q    " "@    " "8:00    " "12:00-14:30    " "9:30-10:30    " "量纲    "))
(setq org-tags-history '("restart" "CFD" "emacs" "Emacs" "Flurry" "CPP" "HPC" "VI" "Emacs:" "交流" "FRLES" "FR" "git" ":Flurry:" "CPP:" "C++" "Ubuntu" "C/C++" "reading" "study" "study:" ":life:" "life" "research:" "research" "future"))
(setq query-replace-history '("\\textbf{S}" "S" "flurry" "" "FR-LES" "Flurry" "STARTED" "HOLD"))
(setq ido-file-history '("grid2.png" "knowlege.org" "gtd.org" "." "report11.org" "report.org" "report11" "test.org" ".Xauthority" "boundFace.cpp" "datetree.org" "test.tex" "report10" "test1.org" "boundFace.hpp" "input" "solver.cpp" "flux.hpp" "solver.hpp" "frles.cpp" "README.org" "README.md" "ele.cpp" nil "flurry.cpp" "init-fonts.el" "1-s2.0-S0889974602904494-main.pdf"))
(setq minibuffer-history '("三角单元$p=2$时，边界点的编号。" "+30" "30" "+20" "report9.org" "report11.org" "org-cdlatex-mode" "bibtex-initialize" "-10" "+36" "+10" "1:00" "13:0" "dired" "report.org" "report11" "1" "28" "+15" "+5" "undo-tree-mode" "ediff-directories" "+35" "+1" "+32" "+27" "16:00" "40" "10" "_5" "+2" "+40" "+31" "—5" "+47" "+34" "12" "ecb-deactivate" "=10" "eq:" "-5" "sec:" "总结" "section" "cccc" "H" "fig:" "Evans和X. Nicolas模拟结果的流函数和温度等值线分布。" "PRB流动示意图" "Figure/prg.png" "流数据" "subsection" "流线图" "PRB.tex" "边界条件" "控制方程" "color-theme-sanityinc-tomorrow-day" "article" "amsmath" "cscope-help" "gud-gdb" "color-theme-sanityinc-solarized-light" "2:00" "shell" "direx:direx-mode" "which-key-mode" "ediff" "80" "color-theme-sanityinc-tomorrow-eighties" "color-theme-sanityinc-tomorrow-blue" "gdb" "customize-option" "gdb-enable-debug" "ecb-show-ecb-windows" "ecb-redraw-layout" "package-list-packages" "pomodoro-stop" "pomodoro-resume" "shell-mode" "eshell" "package-install" "pomodoro-start" "20" "weibo.com" "cua-mode" "+50" "+60" "-120" "+490" "45" "color-theme-select" "5" "linum-mode"))
(setq search-ring 'nil)
(setq regexp-search-ring '(";" "R" " " "calc" "calcI" "cal" "scr" "rusan" "calcAv" "setup" "fl" "flurry" "flu" "wo" "calcR" "development"))
(setq kill-ring '(#("   #+attr_latex: width=$1\\textwidth

 
   
   
" 0 3 (face org-meta-line font-lock-fontified t fontified t) 3 35 (face org-meta-line font-lock-fontified t fontified t) 35 36 (fontified t) 36 37 (fontified t) 37 38 (fontified t) 38 39 (fontified t) 39 42 (fontified t) 42 43 (fontified t) 43 46 (fontified t) 46 47 (fontified t)) #("
" 0 1 (fontified t)) #("$0" 0 2 (fontified t)) #("   #+attr[[file:figure/grid2.png][三角单元$p=2$时，边界点的编号。]]_latex: width=\\textwidth" 0 3 (fontified t font-lock-fontified t) 3 9 (fontified t font-lock-fontified t) 9 11 (fontified t org-no-flyspell t invisible org-link keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight font-lock-multiline t help-echo "LINK: file:figure/grid2.png" htmlize-link (:uri "file:figure/grid2.png") face org-link) 11 33 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) invisible org-link font-lock-multiline t help-echo "LINK: file:figure/grid2.png") 33 34 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) invisible org-link font-lock-multiline t help-echo "LINK: file:figure/grid2.png" rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link)) 34 51 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) font-lock-multiline t help-echo "LINK: file:figure/grid2.png") 51 52 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) font-lock-multiline t help-echo "LINK: file:figure/grid2.png" rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link)) 52 53 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) invisible org-link font-lock-multiline t help-echo "LINK: file:figure/grid2.png") 53 54 (fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) invisible org-link font-lock-multiline t help-echo "LINK: file:figure/grid2.png" rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link)) 54 59 (fontified t font-lock-fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png][三角单元$p=2$时，边界点的编号。]]_latex") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse))) 59 60 (fontified t font-lock-fontified t org-no-flyspell t mouse-face highlight face org-link htmlize-link (:uri "file:figure/grid2.png][三角单元$p=2$时，边界点的编号。]]_latex") keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link)) 60 78 (fontified t font-lock-fontified t)) #("   
" 0 3 (fontified t) 3 4 (fontified t)) #("    
" 0 3 (fontified t) 3 4 (fontified t) 4 5 (fontified t)) #("
" 0 1 (fontified t)) "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma \\Bigg[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\mathbf{r}_{i}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Bigg]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma \\Bigg[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Bigg]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma \\Bigg[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big\\Bigg]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" #("\\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big" 0 5 (fontified t) 5 7 (fontified t) 7 21 (fontified t) 21 23 (fontified t) 23 70 (fontified t) 70 71 (fontified t) 71 72 (fontified t) 72 73 (fontified t) 73 109 (fontified t)) #("\\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big" 0 5 (fontified t) 5 7 (fontified t) 7 21 (fontified t) 21 23 (fontified t) 23 70 (fontified t) 70 71 (fontified t) 71 72 (fontified t) 72 73 (fontified t) 73 109 (fontified t)) "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma \\Bigg[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}\\Bigg]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma [\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\phi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\psi_{f,j}(\\mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{f=1}^{N_f}\\sum_{j=1}^{N_{fp}} \\psi_{f,j}(mathbf{r}_{i}) \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{f,j} \\Big] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\Big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m} \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{i,s,m} \\Big] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma \\big[  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m} \\big( \\hat{F}_{n}-\\bar{F}_{n} \\big)_{i,s,m} \\big] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma [  \\big( \\nabla\\cdot \\mathbf{\\hat{F}} \\big) \\big|_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma [  ( \\nabla\\cdot \\mathbf{\\hat{F}}) \\bbig|_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma [ \\bbig ( \\nabla\\cdot \\mathbf{\\hat{F}} \\bbig)\\bbig |_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 2是两种二维非结构单元上 $p=2$ 时求解点和通量点的分布。单元内求解点上和边界点上的通量，可以通过拉格朗日插值方法内插和外插分别得到得到。在不同单元交界面的通量点上，两边插值得到的通量是不连续的。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：

\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})\\bbig |_{\\mathbf{r}_{i}} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" #("    :LOGBOOK:  
    CLOCK: [2017-06-30 Fri 19:54]--[2017-06-30 Fri 20:06] =>  0:12
    :END:      
" 0 2 (face org-special-keyword fontified t org-effort "0:10" org-category #("Lists" 0 5 (fontified t face org-property-value org-category "gtd" org-category-position 57155)) org-category-position 57155) 2 4 (face org-special-keyword fontified t org-effort "0:10" org-category #("Lists" 0 5 (fontified t face org-property-value org-category "gtd" org-category-position 57155)) org-category-position 57155) 4 5 (face org-special-keyword fontified t) 5 6 (face org-special-keyword fontified t) 6 7 (face org-special-keyword fontified t) 7 12 (face org-special-keyword fontified t) 12 13 (face org-special-keyword fontified t) 13 14 (face org-special-keyword fontified t) 14 15 (face org-special-keyword fontified t) 15 16 (fontified t) 16 20 (fontified nil) 20 26 (face org-special-keyword fontified nil) 26 27 (fontified nil) 27 48 (face org-date keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified nil) 48 49 (face org-date rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link) keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified nil) 49 51 (fontified nil) 51 73 (fontified nil) 73 77 (fontified nil) 77 82 (fontified nil) 82 83 (fontified nil) 83 87 (face org-special-keyword fontified t) 87 92 (face org-special-keyword fontified t) 92 98 (fontified t) 98 99 (fontified t)) #("内部点(Solution Points)和通量点(Flux Points)上的通量" 0 3 (fontified t) 3 12 (fontified t) 12 19 (fontified t) 19 24 (fontified t) 24 29 (fontified t) 29 36 (fontified t) 36 41 (fontified t)) "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{二维四边形和三角形单元 $p=2$ 时求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=2$时的四边形和三角形单元上求解点(Solutions Points)和通量点(Flux Points)的分布，分别使用蓝色圆圈和红色方块表示。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.6cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=3$ 时的节点分布。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=4cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=3$ 时的节点分布。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.5cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=3$ 时的节点分布。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=3.5cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=3$ 时的节点分布。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
\\centering
\\subfigure[四边形单元]{
\\label{fig:subfig:a} %% label for first subfigure
\\includegraphics[width=4cm]{./figure/grid.png}}
\\hspace{1cm}
\\subfigure[三角形单元]{
\\label{fig:subfig:b} %% label for second subfigure
\\includegraphics[width=4cm]{./figure/grid1.png}}
\\caption{2维情况下 $p=3$ 时的节点分布。}
\\label{fig:subfig} %% label for entire figure
\\end{figure}

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" #("
" 0 1 (fontified t)) #("   \\begin{figure}[htbp]
   \\centerline{\\includegraphics[width=4cm]{./figure/grid.png}}
   \\caption[]{2维情况下 $p=3$ 时的节点分布。}
   \\end{figure}   
" 0 23 (fontified t) 23 24 (fontified t) 24 86 (fontified t) 86 87 (fontified t) 87 121 (fontified t) 121 122 (fontified t) 122 140 (fontified t) 140 141 (fontified t)) "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
  \\centering
  \\subfigure[四边形单元]{
    \\label{fig:subfig:a} %% label for first subfigure
    \\includegraphics[width=4cm]{./figure/grid1.png}}
  \\hspace{1cm}
  \\subfigure[三角形单元]{
    \\label{fig:subfig:b} %% label for second subfigure
    \\includegraphics[width=4cm]{./figure/grid1.png}}
  \\caption{2维情况下 $p=3$ 时的节点分布。}
  \\label{fig:subfig} %% label for entire figure
\\end{figure}
\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=4cm]{./figure/grid.png}}
\\caption[]{2维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[H]
  \\centering
  \\subfigure[四边形单元]{
    \\label{fig:subfig:a} %% label for first subfigure
    \\includegraphics[width=4cm]{./figure/grid1.png}}
  \\hspace{1cm}
  \\subfigure[三角形单元]{
    \\label{fig:subfig:b} %% label for second subfigure
    \\includegraphics[width=4cm]{./figure/grid1.png}}
  \\caption{2维情况下 $p=3$ 时的节点分布。}
  \\label{fig:subfig} %% label for entire figure
\\end{figure}
\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=4cm]{./figure/grid.png}}
\\caption[]{2维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" #("Big Box" 0 4 (fontified t) 4 7 (fontified t)) #("Small Box with a Long Caption" 0 5 (fontified t) 5 9 (fontified t) 9 14 (fontified t) 14 16 (fontified t) 16 21 (fontified t) 21 29 (fontified t)) #("./figure/grid1.png}" 0 17 (fontified t) 17 18 (fontified t rear-nonsticky t) 18 19 (fontified t)) #("./figure/grid1.png}" 0 17 (fontified t) 17 18 (fontified t rear-nonsticky t) 18 19 (fontified t)) #("./figure/grid.png" 0 17 (fontified t)) #("./figure/grid.png" 0 17 (fontified t)) #("2维情况下 $p=3$ 时的节点分布。" 0 19 (fontified t)) #("2维情况下 $p=3$ 时的节点分布。" 0 19 (fontified t)) "\\begin{figure}
  \\centering
  \\subfigure[Small Box with a Long Caption]{
    \\label{fig:subfig:a} %% label for first subfigure
    \\includegraphics[width=1.0in]{pic1.eps}}
  \\hspace{1in}
  \\subfigure[Big Box]{
    \\label{fig:subfig:b} %% label for second subfigure
    \\includegraphics[width=1.5in]{pic.eps}}
  \\caption{Two Subfigures}
  \\label{fig:subfig} %% label for entire figure
\\end{figure}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=4cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 上的Navier-Stokes方程转化到计算域 $(\\xi,\\eta,\\zeta)$ 上的方程 。定义如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

则二维Navier-Stokes方程在计算域上可写成下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 证明了在线性情况下，FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次提出格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次应用了p该格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值方法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次应用了p该格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值方法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{空间离散}
\\label{sec-3-2}
空间离散使用Flux Reconstruction(FR)格式。FR格式的思想是由Huynh首次提出的， 他对1D守恒律首次应用了该格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



方程(15)中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。






\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" #("预处理FR格式" 0 3 (face org-level-2 fontified t) 3 5 (fontified t face org-level-2) 5 7 (fontified t face org-level-2)) #("    
" 0 3 (fontified t) 3 4 (fontified t) 4 5 (fontified t)) #("算法" 0 2 (fontified t face org-level-1)) #("    :LOGBOOK:  
    CLOCK: [2017-06-30 Fri 17:15]--[2017-06-30 Fri 19:26] =>  2:11
    :END:      
" 0 2 (face org-special-keyword fontified t org-effort "0:10" org-category #("Lists" 0 5 (fontified t face org-property-value org-category "gtd" org-category-position 57155)) org-category-position 57155) 2 4 (face org-special-keyword fontified t org-effort "0:10" org-category #("Lists" 0 5 (fontified t face org-property-value org-category "gtd" org-category-position 57155)) org-category-position 57155) 4 5 (face org-special-keyword fontified t) 5 6 (face org-special-keyword fontified t) 6 7 (face org-special-keyword fontified t) 7 12 (face org-special-keyword fontified t) 12 13 (face org-special-keyword fontified t) 13 14 (face org-special-keyword fontified t) 14 15 (face org-special-keyword fontified t) 15 20 (fontified t) 20 26 (face org-special-keyword fontified t) 26 27 (fontified t) 27 49 (face org-date keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified t) 49 51 (face org-date keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified t) 51 72 (face org-date keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified t) 72 73 (face org-date rear-nonsticky (mouse-face highlight keymap invisible intangible help-echo org-linked-text htmlize-link) keymap (keymap (follow-link . mouse-face) (mouse-3 . org-find-file-at-mouse) (mouse-2 . org-open-at-mouse)) mouse-face highlight org-no-flyspell t fontified t) 73 77 (fontified t) 77 82 (fontified t) 82 83 (fontified t) 83 87 (face org-special-keyword fontified t) 87 92 (face org-special-keyword fontified t) 92 98 (fontified t) 98 99 (fontified t)) "司徒美堂" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{预处理FR格式}
\\label{sec-3-2}
Flux Reconstruction格式的思想是由Huynh首次提出的， 他对1D守恒律首次应用了该格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。有了单元上点的分布和点上某一时刻的原始变量值，通过拉格朗日插值方法得到内部点(Solution Points)和通量点(Flux Points)上的通量。由于不同单元边界点上的通量不同，通量在单元交界面上出现间断。FR格式采用求解近似黎曼解的方法在通量点得到连续的交界面通量。最后的右端项有两部分构成，一部分是单元内部求解点的散度，另一部分是通过对每个通量点修正得到的。和间断有限元(Discontinuous Galerkin FEM)采用的积分格式不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上都有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



其中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。







\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}" "\\documentclass[a4paper]{article}
                \\usepackage{graphicx}
                \\usepackage{xcolor}
                \\usepackage{xeCJK}
                \\usepackage{lmodern}
                \\usepackage{verbatim}
                \\usepackage{fixltx2e}
                \\usepackage{longtable}
                \\usepackage{float}
                \\usepackage{tikz}
                \\usepackage{wrapfig}
                \\usepackage{textcomp}
                \\usepackage{listings}
                \\usepackage{geometry}
                \\usepackage{marvosym}
                \\usepackage{wasysym}
                \\usepackage{latexsym}
                \\usepackage{fancyhdr}
                \\usepackage[xetex,colorlinks=true,CJKbookmarks=true,linkcolor=black,urlcolor=black, menucolor=black]{hyperref}
                \\fancyfoot[C]{\\bfseries\\thepage}
                \\chead{\\MakeUppercase\\sectionmark}
                \\pagestyle{fancy}
                \\tolerance=1000
                

\\usepackage{subfigure}
\\usepackage{indentfirst} % 中文段落首行缩进
\\geometry{inner=1in,outer=1.5in,vmargin=1in,marginparwidth=1in}
\\linespread{1.5}
\\usepackage{fancyhdr}
\\usepackage{amsmath}
\\pagestyle{fancy}
\\author{yu@yu}
\\date{\\today}
\\title{Report11}
\\hypersetup{
  pdfkeywords={},
  pdfsubject={},
  pdfcreator={}}
\\begin{document}

\\maketitle
\\tableofcontents

\\bibliographystyle{plain}
\\section{引言}
\\label{sec-1}
自然对流现象广泛存在于自然界和各种工程问题中，例如：地球上的大气和海洋对流对天气和气候的影响、核反应堆中的换热、发射性废料的冷却、晶体生长和金属制备过程中的对流等。Rayleigh-Benard(RB)对流系统是从众多自然现象中抽象出来的研究对流问题的经典流体力学模型。过去几十年，研究人员对RB系统进行了大量研究，RB模型已经成为研究流动稳定性、非线性动力学特征的典型模型之一。

尽管RB对流系统是一个简化的模型，但由于影响系统的变量较多，RB系统的演化仍然非常复杂。因此，进一步假设流体的各种物理性质，如流体的密度 $\\rho$ 、黏性系数 $\\nu$ 、热膨胀系数 $\\alpha$ 和热扩散系数 $\\kappa$ 等，均不随随温度变化。仅当考虑浮力项时，流体的密度和温度线性相关，即 $\\rho(T)=\\rho(T_{0})[1-\\alpha (T-T_{0})]$ 。以上假设就是著名的Obebeck-Boussinesq(OB)近似，在该假设下，RB系统为不可压流动，可以用不可压Navier-Stokes方程描述。OB假设仅仅在温差比较小的时候成立，对于气体，该假设成立的温差不大于 $30K$ 。当温差较大的时候，流体的密度等物理量将随温度变化，此时称为Non-Obebeck-Boussinesq(NOB)流动。为了统一计算OB和NOB两种情况下的RB流动，本文中直接对可压缩的Navier-Stokes方程进行求解。

使用基于可压缩Navier-Stokes方程的程序计算不可压流动时，会遇到残差很难收敛的问题。这是由于马赫数很小，流场速度相对于声速存在的巨大量级差异，导致方程系统的刚性很强，一些常用的迎风格式，如Roe格式精度和效率都会急剧下降。为了克服低马赫流动难以收敛这一困题，最常用的方法是对方程进行预处理。预处理的基本思想是给方程组物理时间项乘以一个预处理矩阵，改变系统的特征值，进而降低整个系统的刚性。 经过预处理之后，系统的特征值量级将被拉平，此时可以以较大的时间步长进行时间推进。由于只是对物理时间项进行处理，预处理只是起到了加速收敛的结果，并不会影响系统的静态解。学术界提出了许多不同的预处理方案，这些方法大致可以归为三类:第一类是Turkel \\cite{Turkel1999PRECONDITIONING}提出的预处理方法，该类方法的受到了Chorin的人工压缩性方法的影响， 在推导预处理矩阵过程中使用熵(Entrory)作为独立变量;第二类是基于温度推导来的。 Choi-Merkel \\cite{Choi1993The}、Weiss-Smith \\cite{Weiss1995Preconditioning}等预处理方法都属于这类; 还有一类方法是由Van Leer \\cite{Bram2013Characteristic} 发展的，这类预处理方法被认为是最优的(optimal)，因为它将系统的特征值在所有的马赫数范围都拉平了。不同的预处理方法对精度的影响类似，但鲁棒性不同，经过作者实际，发现Turkel预处理矩阵的鲁棒性强于Choi-Merkel等方法。

本文的主要内容是使用对高精度FR格式进行预处理，并用其计算OB假设下的RB流动，并与经典的不可压求解器的结果进行对比。接下来，本文的第二部分主要介绍做右侧壁加热的RB模型和其对应的控制方程。第三部分介绍高精度格式的预处理方法以及数值通量的处理。第三部分是数值实验的结果，使用不同网格和阶数对4个瑞利数进行计算，并与其他结果对比。证明使用可压缩方程计算结果和不可压接近。

\\section{模型和控制方程}
\\label{sec-2}
\\subsection{模型}
\\label{sec-2-1}
Figure 1 是左右温差RB热对流系统的示意图。上下壁面为绝热壁面，左右壁面保持恒温，左边温度高于右边，温差为 $\\Delta T$ 。对流槽的几何形状可以通过其对称性和宽高比来描述，宽高比的定义为 $\\Gamma = D/L$ ，其中 $D$ 是对流槽的横截面直径， $L$ 为左右温差壁面的距离。对于给定几何形状的对流槽，RB热对流系统仅由两个无量纲的控制参数决定，即Rayleigh(Ra)数和Prandtl(Pr)数。这两个参数的定义分别如下,
\\begin{equation}
Ra=\\alpha g \\Delta T H^{3}/\\nv \\kappa,\\quad Pr = \\nu/\\kappa      
\\end{equation}

\\begin{figure}[htb]
\\centering
\\includegraphics[width=5cm　]{./figure/RB.png}
\\caption{左右温差RB热对流系统}
\\end{figure}

$Ra$ 数是无量纲化的温差，刻画的是热流驱动对流运动的强度； $Pr$ 数是流体本身的属性，表征流体动量扩散和热扩散之间的强弱。当 $Ra$ 数较小的时,系统不发生对流，此时传热方式为热传递；当系统 $Ra$ 逐渐增大并超过某一临界值 $Ra_{cr}$ 后，系统将失去稳定性，产生热对流。在重力的作用下，左右两边壁面会分别形成上升流动和下降流动，在腔内形成回流，此时的传热以对流传热为主。在RB对流系统的研究中，最关心的是对流传热的效率。因此，分别定义局部和平均Nusselt数来表征系统的传热特征，

\\begin{equation}
Nu(y) = \\frac{L}{k_{0}(T_{h}-T_{c})}k \\frac{\\partial T}{\\partial x} \\bigg|_{w}, \\quad \\overline{Nu}=\\frac{1}{L} \\int_0^L Nu(y)dy      
\\end{equation}

(2)中的 $\\kappa(T)$ 是流体的热导率，并且 $\\kappa_{0} = \\kappa(T_{0})$ 。当温差较小时，OB假设成立，可以认为热导率不随温度变化，即$\\kappa(T) \\equiv \\kappa_{0}$ 。在本文中，RB热对流系统的宽高比$\\Gamma = 1$ ,　固定Prandtl数为0.71，分别令$Ra$ 数从 $10^{3}$ 到  $10^{6}$ 变化，计算结果并与其他结果比较。


\\subsection{控制方程}
\\label{sec-2-2}
刻画该问题的是如下的控制方程：
\\begin{equation}
\\frac{\\partial \\textbf{U}}{\\partial t}   + \\frac{\\partial \\textbf{F}_{i}}{\\partial x_{i}}=\\textbf{S}
\\end{equation}

上式中，$\\textbf{U}$ 是守恒变量：

\\begin{equation}
  \\textbf{U} = (\\rho,\\rho u_{1},\\rho u_{2},\\rho e )^{T}
\\end{equation}

$u_{i}$ 表示 $i$ 方向额速度分量 $\\rho e$ 表示单位质量气体的总能量 ：

\\begin{equation*}
\\rho e = \\rho C_{v} T + \\frac{1}{2} \\rho (u_{1}^{2}+u_{2}^{2})
\\end{equation*}

在方程(1)中，$\\texbf{F}_{i}$ 是 $i$ 方向的通量：

\\begin{equation}
   \\textbf{F}_{i}=
   \\begin{pmatrix}
   \\rho u_{i}\\\\  
   \\rho u_{i} u_{1} + p \\delta_{i1} - \\mu A_{i1} \\\\
   \\rho u_{i} u_{2} + p \\delta_{i2} - \\mu A_{i2} \\\\
   \\rho u_{i} u_{3} + p \\delta_{i3} - \\mu A_{i3} \\\\
   (\\rho e + p) u_{1} - \\mu A_{ij} u_{j} - k\\frac{\\partial T}{\\partial x_{i}}
   \\end{pmatrix}
   ,i = {1,2,3}
   \\end{equation}


在方程(3)中，压强 $p$ 满足理想气体状态方程 $p = \\rho R T$ 。 $A_{ij}$ 是应力项，其具体形式如下：
\\begin{equation*}
A_{ij} = \\frac{1}{2}(\\frac{\\partial u_{i}}{\\partial x_{j}}+\\frac{\\partial u_{i}}{\\partial x_{j}}-\\frac{2}{3}(\\nabla \\cdot u)\\delta_{ij})
\\end{equation*}

(1)中右端项 $\\textbf{S}$ 为浮力项，其作用相当于不可压流动的OB假设。

\\begin{equation}
  \\begin{align*}
  &\\textbf{S} = (S_{\\rho},S_{\\rho u_{1}},S_{\\rho u_{2}},S_{\\rho e})^{T}\\\\
  &S_{\\rho u_{2}} = g\\alpha (T_{ref}-T); \\quad \\alpha = \\frac{1}{T}\\\\
  &S_{\\rho} = S_{\\rho u_{1}} =  0\\\\
  &S_{\\rho e} = u_{1} S_{\\rho u_{1}} +u_{2} S_{\\rho u_{2}}
  \\end{align*}     
\\end{equation}

\\section{数值算法}
\\label{sec-3}
\\subsection{预处理方法}
\\label{sec-3-1}
预处理方法的核心是通过给物理时间导数项乘上一个预处理矩阵 $\\Gamma^{-1}$ ， 使得预处理后的系统的特征值量级相近， 进而降低了系统的刚度。 下面以二维的方程为例来介绍预处理的思想。 假设经过坐标变换后的方程如下:

\\begin{equation}
\\Gamma^{-1} \\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial \\xi}+\\frac{\\partial \\mathbf{G}}{\\partial \\eta}=\\mathbf{S}
\\end{equation}

上述系统在 $\\xi$ 方向的特征值分别为 $U_{\\xi}$ ， $U_{\\xi}$ 和 $U_{\\xi} \\pm \\sqrt{(\\xi_{x})^{2}+(\\xi_{y})^{2}}$ ， 当 $Ma$ 很小的时候，上述特征值相差几个量级。

给左端乘以一个预处理矩阵后，整理得

\\begin{equation}
\\frac{\\partial \\mathbf{U}}{\\partial t} = - \\Gamma \\mathbf{R} ， 
\\end{equation}

其中，$R$ 是右端的余项。 预处理矩阵采用Turkel形式， 转换成守恒形式如下:


\\begin{equation}
\\mathbf{\\Gamma}=
\\begin{bmatrix}
\\frac{M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{u(1-\\gamma)\\Theta}{c^{2}} & \\frac{v(1-\\gamma)\\Theta}{c^{2}}&  \\frac{(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{u M^{2}(\\gamma-1)\\Theta}{2} & \\frac{u^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{uv(1-\\gamma)\\Theta}{c^{2}} & \\frac{u(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{v M^{2}(\\gamma-1)\\Theta}{2}+1 & \\frac{vu(1-\\gamma)\\Theta}{c^{2}} & \\frac{v^{2}(1-\\gamma)\\Theta}{c^{2}}+1 & \\frac{v(\\gamma-1)\\Theta}{c^{2}} \\\\
\\frac{M^{2}c^{2}\\Theta }{2}(\\frac{(\\gamma-1)\\Theta}{2}+1) & \\Theta u (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\Theta v (\\frac{M^{2}(1-\\gamma)}{c^{2}}-1) & \\frac{M^{2}(\\gamma-1)\\Theta}{c^{2}}+\\epsilon\\\\
\\end{bmatrix}        
\\end{equation}

经过预处理后系统的 $\\xi$ 方向的特征值为，

\\begin{equation}
U_{\\xi}, U_{\\xi}, \\frac{U_{\\xi}}{2}(1+\\epsilon) \\pm \\frac{1}{2}\\sqrt{\\Theta^{2}U_{\\xi}+4\\epsilon (\\xi_{x}^{2}+\\xi_{y}^{2})c^{2}}，
\\end{equation}

其中 $\\epsilon = MIN[MAX(M^{2},M^{2}_{min}),1]$ ， 其中 $\\Theta = \\epsilon -1$ 。 数值实验证明， $\\epsilon$ 的选择对求解器的稳定性影响非常大， 根据Turkel的建议， $\\epsilon$ 应该和局部马赫数 $M^{2}$ 成正比。$M_{min}$ 是为了避免在物面等位置出现出现奇点。本文中的算例，取 $M_{min} = M_{\\infty}^{2}/2$ 。

\\subsection{预处理FR格式}
\\label{sec-3-2}
Flux Reconstruction格式的思想是由Huynh首次提出的， 他对1D守恒律首次应用了该格式， 并证明在线性情况下， FR格式统一了nodal DG和SD等格式。Wang和Gao通过“抬升算子”将该方法推广到四面体和六面体的Euler方程和Navier-Stokes方程系统。 他们的工作总结为CPR（Correction Procedure via Reconstruction）格式。 后来， Vincent、Castonguay和Jameson在FR的框架下得到了一组无穷阶线性能量稳定的格式,并命名为VCJH格式。 相比DG类方法， FR方法在概念上更加简单，并且不需要积分过程，因此效率更高。而且通过调整参数，FR可以返回其他高精度格式（至少线性情况下）。

下面简介FR方法的基本思想。 首先将物理域单元 $(x,y,z)$ 转化到计算域 $(\\xi,\\eta,\\zeta)$ 。则有如下坐标变换:

\\begin{equation}
\\begin{align}
&\\hat{U}=|J|U\\\\
&\\hat{F}=|J|(\\xi_{x}F^{x}+\\xi_{y}F^{y}+\\xi_{z}F^{z})\\\\
&\\hat{G}=|J|(\\eta_{x}G^{x}+\\eta_{y}G^{y}+\\eta_{z}G^{z})\\\\
\\end{align}     
\\end{equation}

其中，雅克比矩阵 $J$ 定义如下,

\\begin{equation}
J = \\frac{\\partial (x,y)}{\\partial (\\xi, \\eta)} =
\\begin{bmatrix}
x_{\\xi}&x_{\\eta}\\\\
y_{\\xi}&y_{\\eta}\\\\
\\end{bmatrix}
\\end{equation}

雅克比矩阵的特征值，

\\begin{equation}
\\big | J \\big | = x_{\\xi}y_{\\eta}-y_{\\xi}x_{\\eta}
\\end{equation}

经过坐标变换后的二维Navier-Stokes方程有下面的形式，

\\begin{equation}
\\frac{\\partial \\mathbf{\\hat{U}}}{\\partial t}+ \\Gamma(\\hat{\\nabla}\\cdot \\mathbf{\\hat{F}}) = \\frac{\\partial \\hat{U}}{\\partial t} + \\Gamma(\\frac{\\partial \\hat{F}}{\\partial \\xi}+\\frac{\\partial \\hat{G}}{\\partial \\eta}  ) = 0
\\end{equation}

方程(14)中，$\\mathbf{\\hat{U}}$ 是计算域上的守恒变量， $\\mathbf{\\hat{F}}=(\\hat{F},\\hat{G})$ 是计算域上的通量, $\\Gamma$ 是(9)中的守恒变量的预处理矩阵。p

\\begin{figure}[htbp]
\\centerline{\\includegraphics[width=9cm]{./figure/grid.png}}
\\caption[]{3维情况下 $p=3$ 时的节点分布。}
\\end{figure}   

Figure 1是三维各种非结构单元上 $p=3$ 的一个点的分布。 和DG不同，FR方法是微分型的格式。既在第 $i$ 个单元上第 $j$ 节点上有如下的半分离格式：
\\begin{equation}
\\begin{align*}
\\frac{\\partial \\hat{U}_{i,j}}{\\partial t} &= -\\Gamma [ (\\nabla\\cdot \\mathbf{\\hat{F}})_{i,j} + \\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}] \\\\
&= -\\Gamma[\\frac{\\partial \\hat{F}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\frac{\\partial \\hat{G}}{\\partial \\xi}\\bigg |_{\\hat{U}_{i,j}}+\\sum_{s=1}^{N_{s}}\\sum_{m=1}^{K_{s}} \\psi_{j,s,m}(\\hat{F}_{n}-\\bar{F}_{n})_{i,s,m}]\\\\
&=-\\Gamma \\mathbf{R}
\\end{align*}     
\\end{equation}



其中， $N_{s}$ 是单元上面的个数， $K_{s}$ 是每个面上的点的个数. $\\bar{F}_{n}$ 是数值通量(Numerical Flux)。无粘性通过Riemann Solver计算，粘性项通过中心平均的方法求得。 $\\psi_{j,s,m}$ 是修正场, 每个单元面节点都对于一个修正场，该场在计算前已经计算过。FR格式通过修改修正场返回DG、SD等其它高精度数值格式。
因为预处理改变了系统的特征值， 因此计算无粘数值通量的时候需要对Riemann Solver进行修正。
修正后的谱半径有如下的形式：

\\begin{equation}
\\rho(\\Gamma^{-1}_{w}D_{w})=u^{\\prime}_{n} + c^{\\prime}
\\end{equation}

其中,
\\begin{equation}
\\begin{align*}
 u_{n}^{\\prime} &=\\frac{u_{n}}{2}(1+\\epsilon),\\\\
 c^{\\prime} &= \\frac{1}{2}\\sqrt(u_{n}^{2}(1-\\epsilon)^{2}+4\\epsilon |s|^{2}),&\\\\
 u_{n} &=u s_{x}+v s_{y}+w s_{z},&\\\\
 s &=\\sqrt{s^{2}_{x}+s^{2}_{y}+s^{2}_{z}}, 
\\end{align*}     
\\end{equation}

经过预处理之后的特征值量级相近，时间步长相比未预处理时大幅增大，提高了计算的效率。

\\subsection{数值通量}
\\label{sec-3-3}
方程(12)的中数值通量 $\\bar{F}^{\\xi}_{n}$ 采用预处理的Roe格式近似黎曼解。数值通量如下：

\\begin{equation}
\\bar{F}^{\\xi}_{n}^{Roe} = \\frac{1}{2} (\\mathbf{F_{L}}\\cdot \\mathbf{n}+\\mathbf{F_{R}}\\cdot \\mathbf{n}) - \\frac{1}{2}\\Gamma^{-1} |\\Gamma \\tilde{\\mathbf{A}}| \\Delta \\mathbf{U}
\\end{equation}

其中， $\\Delta \\mathbf{U}$ 是左右两端守恒变量的差值，$\\Gamma$ 为守恒变量的预处理矩阵。$\\tilde{\\mathbf{A}}=\\mathbf{A(\\tilde{\\mathbf{U}})}$ 表示Roe平均矩阵，符号“～”表示使用的是Roe平均变量。对于未预处理的系统，方程(17)等价于原来标准的Roe格式。







\\subsection{空间离散}
\\label{sec-3-4}
\\section{数值结果}
\\label{sec-4}
\\subsection{初始条件}
\\label{sec-4-1}

\\bibliography{rb}
\\end{document}"))
